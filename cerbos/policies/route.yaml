# yaml-language-server: $schema=https://api.cerbos.dev/latest/cerbos/policy/v1/Policy.schema.json

---
apiVersion: api.cerbos.dev/v1
resourcePolicy:
  version: "default"
  resource: "route"
  rules:
    - actions:
        - "*"
      effect: EFFECT_ALLOW
      roles:
        - DENY

    - actions:
        - GET
      effect: EFFECT_ALLOW
      roles:
        - ADMIN

    - actions:
        - GET
      effect: EFFECT_ALLOW
      roles:
        - USER
      condition:
        match:
          expr: R.attr.search.contains("letmein")
